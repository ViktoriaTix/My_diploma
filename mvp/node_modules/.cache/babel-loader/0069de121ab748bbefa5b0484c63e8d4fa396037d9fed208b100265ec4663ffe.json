{"ast":null,"code":"import formatKeyValue from './format.js';\nimport { isFile, isArrayOfFile, FileWithData } from './file.js';\nfunction buildFormData(reqForm) {\n  /**\n   * Build a new FormData instance, support array as field value\n   * OAS2.0 - when collectionFormat is multi\n   * OAS3.0 - when explode of Encoding Object is true\n   *\n   * This function explicitly handles Buffers (for backward compatibility)\n   * if provided as a values to FormData. FormData can only handle USVString\n   * or Blob.\n   *\n   * @param {Object} reqForm - ori req.form\n   * @return {FormData} - new FormData instance\n   */\n  return Object.entries(reqForm).reduce((formData, [name, input]) => {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const [key, value] of formatKeyValue(name, input, true)) {\n      if (Array.isArray(value)) {\n        // eslint-disable-next-line no-restricted-syntax\n        for (const v of value) {\n          if (ArrayBuffer.isView(v)) {\n            const blob = new Blob([v]);\n            formData.append(key, blob);\n          } else {\n            formData.append(key, v);\n          }\n        }\n      } else if (ArrayBuffer.isView(value)) {\n        const blob = new Blob([value]);\n        formData.append(key, blob);\n      } else {\n        formData.append(key, value);\n      }\n    }\n    return formData;\n  }, new FormData());\n}\nexport const stringifyQuery = (queryObject, {\n  encode = true\n} = {}) => {\n  const buildNestedParams = (params, key, value) => {\n    if (Array.isArray(value)) {\n      value.reduce((acc, v) => buildNestedParams(params, key, v), params);\n    } else if (value instanceof Date) {\n      params.append(key, value.toISOString());\n    } else if (typeof value === 'object') {\n      Object.entries(value).reduce((acc, [k, v]) => buildNestedParams(params, `${key}[${k}]`, v), params);\n    } else {\n      params.append(key, value);\n    }\n    return params;\n  };\n  const params = Object.entries(queryObject).reduce((acc, [key, value]) => buildNestedParams(acc, key, value), new URLSearchParams());\n  const queryString = String(params);\n  return encode ? queryString : decodeURIComponent(queryString);\n};\n\n// Encodes an object using appropriate serializer.\nexport function encodeFormOrQuery(data) {\n  /**\n   * Encode parameter names and values\n   * @param {Object} result - parameter names and values\n   * @param {string} parameterName - Parameter name\n   * @return {object} encoded parameter names and values\n   */\n  const encodedQueryObj = Object.keys(data).reduce((result, parameterName) => {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const [key, value] of formatKeyValue(parameterName, data[parameterName])) {\n      if (value instanceof FileWithData) {\n        result[key] = value.valueOf();\n      } else {\n        result[key] = value;\n      }\n    }\n    return result;\n  }, {});\n  return stringifyQuery(encodedQueryObj, {\n    encode: false\n  });\n}\n\n// If the request has a `query` object, merge it into the request.url, and delete the object\n// If file and/or multipart, also create FormData instance\nexport function serializeRequest(req = {}) {\n  const {\n    url = '',\n    query,\n    form\n  } = req;\n  const joinSearch = (...strs) => {\n    const search = strs.filter(a => a).join('&'); // Only truthy value\n    return search ? `?${search}` : ''; // Only add '?' if there is a str\n  };\n  if (form) {\n    const hasFile = Object.keys(form).some(key => {\n      const {\n        value\n      } = form[key];\n      return isFile(value) || isArrayOfFile(value);\n    });\n    const contentType = req.headers['content-type'] || req.headers['Content-Type'];\n    if (hasFile || /multipart\\/form-data/i.test(contentType)) {\n      const formdata = buildFormData(req.form);\n      req.formdata = formdata;\n      req.body = formdata;\n    } else {\n      req.body = encodeFormOrQuery(form);\n    }\n    delete req.form;\n  }\n  if (query) {\n    const [baseUrl, oriSearch] = url.split('?');\n    let newStr = '';\n    if (oriSearch) {\n      const oriQuery = new URLSearchParams(oriSearch);\n      const keysToRemove = Object.keys(query);\n      keysToRemove.forEach(key => oriQuery.delete(key));\n      newStr = String(oriQuery);\n    }\n    const finalStr = joinSearch(newStr, encodeFormOrQuery(query));\n    req.url = baseUrl + finalStr;\n    delete req.query;\n  }\n  return req;\n}","map":{"version":3,"names":["formatKeyValue","isFile","isArrayOfFile","FileWithData","buildFormData","reqForm","Object","entries","reduce","formData","name","input","key","value","Array","isArray","v","ArrayBuffer","isView","blob","Blob","append","FormData","stringifyQuery","queryObject","encode","buildNestedParams","params","acc","Date","toISOString","k","URLSearchParams","queryString","String","decodeURIComponent","encodeFormOrQuery","data","encodedQueryObj","keys","result","parameterName","valueOf","serializeRequest","req","url","query","form","joinSearch","strs","search","filter","a","join","hasFile","some","contentType","headers","test","formdata","body","baseUrl","oriSearch","split","newStr","oriQuery","keysToRemove","forEach","delete","finalStr"],"sources":["D:/Vasya/Documents/STUDYING/NSU/4_year/ТехДок/Проект/anakot/node_modules/swagger-client/es/http/serializers/request/index.js"],"sourcesContent":["import formatKeyValue from './format.js';\nimport { isFile, isArrayOfFile, FileWithData } from './file.js';\nfunction buildFormData(reqForm) {\n  /**\n   * Build a new FormData instance, support array as field value\n   * OAS2.0 - when collectionFormat is multi\n   * OAS3.0 - when explode of Encoding Object is true\n   *\n   * This function explicitly handles Buffers (for backward compatibility)\n   * if provided as a values to FormData. FormData can only handle USVString\n   * or Blob.\n   *\n   * @param {Object} reqForm - ori req.form\n   * @return {FormData} - new FormData instance\n   */\n  return Object.entries(reqForm).reduce((formData, [name, input]) => {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const [key, value] of formatKeyValue(name, input, true)) {\n      if (Array.isArray(value)) {\n        // eslint-disable-next-line no-restricted-syntax\n        for (const v of value) {\n          if (ArrayBuffer.isView(v)) {\n            const blob = new Blob([v]);\n            formData.append(key, blob);\n          } else {\n            formData.append(key, v);\n          }\n        }\n      } else if (ArrayBuffer.isView(value)) {\n        const blob = new Blob([value]);\n        formData.append(key, blob);\n      } else {\n        formData.append(key, value);\n      }\n    }\n    return formData;\n  }, new FormData());\n}\nexport const stringifyQuery = (queryObject, {\n  encode = true\n} = {}) => {\n  const buildNestedParams = (params, key, value) => {\n    if (Array.isArray(value)) {\n      value.reduce((acc, v) => buildNestedParams(params, key, v), params);\n    } else if (value instanceof Date) {\n      params.append(key, value.toISOString());\n    } else if (typeof value === 'object') {\n      Object.entries(value).reduce((acc, [k, v]) => buildNestedParams(params, `${key}[${k}]`, v), params);\n    } else {\n      params.append(key, value);\n    }\n    return params;\n  };\n  const params = Object.entries(queryObject).reduce((acc, [key, value]) => buildNestedParams(acc, key, value), new URLSearchParams());\n  const queryString = String(params);\n  return encode ? queryString : decodeURIComponent(queryString);\n};\n\n// Encodes an object using appropriate serializer.\nexport function encodeFormOrQuery(data) {\n  /**\n   * Encode parameter names and values\n   * @param {Object} result - parameter names and values\n   * @param {string} parameterName - Parameter name\n   * @return {object} encoded parameter names and values\n   */\n  const encodedQueryObj = Object.keys(data).reduce((result, parameterName) => {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const [key, value] of formatKeyValue(parameterName, data[parameterName])) {\n      if (value instanceof FileWithData) {\n        result[key] = value.valueOf();\n      } else {\n        result[key] = value;\n      }\n    }\n    return result;\n  }, {});\n  return stringifyQuery(encodedQueryObj, {\n    encode: false\n  });\n}\n\n// If the request has a `query` object, merge it into the request.url, and delete the object\n// If file and/or multipart, also create FormData instance\nexport function serializeRequest(req = {}) {\n  const {\n    url = '',\n    query,\n    form\n  } = req;\n  const joinSearch = (...strs) => {\n    const search = strs.filter(a => a).join('&'); // Only truthy value\n    return search ? `?${search}` : ''; // Only add '?' if there is a str\n  };\n  if (form) {\n    const hasFile = Object.keys(form).some(key => {\n      const {\n        value\n      } = form[key];\n      return isFile(value) || isArrayOfFile(value);\n    });\n    const contentType = req.headers['content-type'] || req.headers['Content-Type'];\n    if (hasFile || /multipart\\/form-data/i.test(contentType)) {\n      const formdata = buildFormData(req.form);\n      req.formdata = formdata;\n      req.body = formdata;\n    } else {\n      req.body = encodeFormOrQuery(form);\n    }\n    delete req.form;\n  }\n  if (query) {\n    const [baseUrl, oriSearch] = url.split('?');\n    let newStr = '';\n    if (oriSearch) {\n      const oriQuery = new URLSearchParams(oriSearch);\n      const keysToRemove = Object.keys(query);\n      keysToRemove.forEach(key => oriQuery.delete(key));\n      newStr = String(oriQuery);\n    }\n    const finalStr = joinSearch(newStr, encodeFormOrQuery(query));\n    req.url = baseUrl + finalStr;\n    delete req.query;\n  }\n  return req;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}